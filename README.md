# Structurizr Mini

C4 diagrams from a [Structurizr](https://structurizr.com) workspace on a static site.

## Features

- Diagrams rendered with the [same code](https://github.com/structurizr/ui) as the official Structurizr [tools](https://structurizr.com/products) so...
  - [Themes](https://structurizr.com/help/themes) just work
  - Diagrams look the same everywhere, so you can mix & match Structurizr tools (I still use [Lite](https://structurizr.com/help/lite) for local diagram editing)
- Zoom and pan with mousewheel or trackpad (like Google Maps, Lucid, Miro, etc)
- Simplified UI with [quick navigation](https://docs.structurizr.com/ui/quick-navigation) and [fuzzy search](https://github.com/farzher/fuzzysort)
- PNG export
- Customisable header — link to your own supplemental docs, source code, etc

## Instructions

- Download and unzip the latest [release](https://github.com/bensmithett/structurizr-mini/releases) somewhere that can serve static files over HTTP
- Put your `workspace.json` in the same place
- Go to `http://[YOUR SERVER]/index.html`

### How to get a `workspace.json`

It depends on where the source of truth for your workspace is, and whether your diagrams use `autoLayout`.

#### If using Structurizr Cloud Service or On-Premises

Use [Structurizr CLI's `pull`](https://docs.structurizr.com/cli/pull)

#### If not

A `workspace.json` generated from a `workspace.dsl` won't include any `autoLayout` information by default. Structurizr's Lite/Cloud/On-Prem diagram viewer applies [Graphviz](https://graphviz.org) on the server when you view a diagram. Mini can't do that — it's just static files — so you need to pre-generate autolayouts.

TODO

## The Structurizr Mini Workflow

Here's the workflow that I built Structurizr Mini to fit into.

- Just diagrams. No [docs](https://docs.structurizr.com/dsl/docs) or [ADRs](https://docs.structurizr.com/dsl/adrs) in the workspace
- `workspace.dsl` is committed to version control
- Use Structurizr Lite to view diagrams while iterating on `workspace.dsl` locally
- `workspace.json` generated by Structurizr Lite is not committed
- Diagrams are all `autoLayout`
  - Occasionally I comment out `autoLayout` and manually tweak a diagram I want to export for a specific purpose.
- CI generates a `workspace.json` from the committed `workspace.dsl`, and publishes a Structurizr Mini site to S3

## Contributing

### Importing assets from [structurizr/ui](https://github.com/structurizr/ui)

This project uses JS & CSS from [structurizr/ui](https://github.com/structurizr/ui) to render diagrams and work with a [JSON workspace](https://github.com/structurizr/cli/blob/master/docs/export.md).

To enable this, structurizr/ui is included as a git submodule. I'm putting this here because I can never remember submodule commands...

```
# After cloning
git submodule update --init --recursive
# To pull in latest changes
git submodule update --recursive --remote
```

structurizr/ui's JS is old school globals (no modules, UMD, or IIFE) so we need to manually bundle and move to `public` for Vite to include it in the final build.

```
pnpm import-structurizr-scripts
```
